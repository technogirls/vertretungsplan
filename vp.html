<html>

<head>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
<!-- https://afeld.github.io/emoji-css/ -->
<link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet">


<script type="text/javascript">
var lehrer = {
"":"Fr. Anger",
"AGM":"Hr. Angermann",
"":"Hr. Anton",
"BACM":"Fr. Bachmann",
"BALD":"Fr.Baldschus",
"BÄR":"Fr. Bär",
"BEGS":"Fr. Bengsch",
"BERN":"Fr.Bernhardt",
"BEY":"Fr. Beykirch",
"BLE":"Hr. Blechschmidt",
"":"Hr. Böhme",
"BÖTT":"Fr. Böttcher",
"BRAN":"Fr. Branzk",
"BRE":"Hr. Brestrich",
"DFÜR":"Hr. Fürstenau",
"DEVA":"Hr. Devantier",
"DOM":"Fr. Dombrowski",
"EIS":"Fr. Eisbein",
"FAB":"Hr. Fabianski",
"FERE":"Hr. Ferencz",
"FIDL":"Hr. Fiedler",
"FISH":"Hr. Fischer",
"FOL":"Fr. Folprecht",
"":" Forkel",
"FORS":" Forster",
"GOCK":"Gockisch",
"GROß":"Fr. Große",
"":"Guttowski",
"":"Fr. Häberlein",
"":"Fr. Hänsel",
"":"Fr. Härter",
"":"Hr. Hegewald",
"":" Hennig",
"":"Fr. Herrmann",
"":"Fr. Herzog",
"":"Fr. Höllige",
"":"Fr. Hornig",
"":"Fr. Hvolka",
"":""
}

//, DEVA, EIS, FISH, HÄNS, JOHN, LIND, MKAY, OSC, STR, TASY"

$(document).ready(function() {
     var xml = undefined;
     function e(name) { return $(xml).find(name).text(); }
     console.log(document.location.href)
	 var href = document.location.href
	 var fuerKlasse = href.substring(href.indexOf("=")+1,href.length);
	 console.log(fuerKlasse)
	 $("h1").text($("h1").text()+" "+fuerKlasse)
     var url = "https://vertretungsplan.bebe-dresden.de/vplan/vdaten/VplanKl.xml"
     $.get(url, function(error,x, data) {
     var text = $.parseXML( data.responseText );
	 xml = text;
     var abwesendklassen = e("abwesendk");
	 var klassen = e("aenderungk");
	 var abwesendlehrer = e("abwesendl");
	 var lehrer = e("aenderungl");
	 var tag = e("titel");
	 $("#tag").text(tag);
	 $("#lehrer").text("Lehrer:" + lehrer);
     var plan = $(xml).find("haupt aktion");
     plan.each(function(){
	    var xml = $(this);
	    function e(name) { return xml.find(name).text() }
        var klasse = e("klasse")
		if (fuerKlasse === undefined || klasse == fuerKlasse) {
		   var name = lehrer[e("lehrer")] || e("lehrer");
           $("#liste").append($("<li>").text(e("stunde")+". "+e("fach")+" in "+e("raum")+" "+" bei "+name+" "+e("info")));   
		}
     })
   })
})

</script>

<style type="text/css">
</style>
</head>

<body>
<h1>Vertretung f&uuml;r </h1>
<h2 id="tag">Tag: </h2>
<ul id="liste">
</ul>
<div id="lehrer">Lehrer: </div>
<div id="klassen">Klassen: </div>
</body>
</html>
